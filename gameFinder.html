<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <!-- imports -->

  <!-- Latest compiled and minified CSS -->
  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css'>
  <!-- Optional theme -->
  <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.css'>
  <!-- Font Awesome minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.css">

  <link rel='stylesheet' href='gameFinder.css'>
  <!-- jQuery -->
  <script src='jquery-2.1.4.js'></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js'></script>

  <script src='tabletop-1.4.2/src/tabletop.js'></script>
  <script src='bootstrap-modal-carousel-master/src/js/carousel-fit.js'></script>
  <script src='bootstrap-modal-carousel-master/src/js/modal-carousel.js'></script>
  <script src='bootstrap-modal-carousel-master/src/js/modal-local.js'></script>

  <script src='gameFinder.js'></script>

  <title>Game Finder</title>
</head>
<body>

  <div id='aboutus'>
    <h4>About Us</h4>
    <p>We're two girls who love games and wanted to make it easier for people to find the games they're really interested in.</p>
  </div>

  <div id='suggestions' class='suggestion-form'>
    <div class='title'>
      <strong>Game not here? Tags not right?</strong><br>
      <strong>Give us some suggestions.</strong>
    </div>
    <form id='suggest' target='_self' onsubmit='' action='javascript:postSuggestion()'>
      <fieldset>
        <label for='gamename'>Game Name</label><br>
        <input id='gamename' type='text' name='gamename'>
      </fieldset>
      <fieldset>
        <label for='gametags'>Tags</label><br>
        <textarea id='gametags' name='gametags'></textarea>
      </fieldset>
      <div style='width:100%; display:block; float:right;'>
        <button class='btn btn-primary' id='send' type='submit'>Suggest</button>
      </div>
      <div style="width: 100%; display: block; float: right; padding-top: 15px;">
        <div class="requestSubmited" style="display:none; text-align: center;">Your request has been sent!</div>
      </div>
    </form>
  </div>

  <div class='container-fluid' id='container'>
    <img src="Header Image For G2G.jpg" style="width: 895px; height: 200px" id='header'>


  <h4 style='text-align:center;'>Search by name or developer</h4>
  <div class='input-group searchBar' id='search'>
    <span class='input-group-btn'>
      <button class='btn btn-primary' type='button' id='searchNameBtn'><i class='fa fa-search'></i></button>
    </span>
    <input type='search' placeholder='Search name or developer.' class='form-control' id='searchField'>
  </div>
  <h5 style='text-align:center;'>--OR--</h5>
  <h4 style='text-align:center;'>Search by filters</h4>

  <div class='container-fluid' id='filterBox'>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='action'/><b> Action</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='adventure'/><b> Adventure</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='anime'/><b> Anime</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='arcade'/><b> Arcade</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='cartoon'/><b> Cartoon</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='ccg'/><b> CCG</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='endless'/><b> Endless</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='energy'/><b> Energy</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='first person'/><b> First Person</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='female protagonist'/><b> Female Protagonist</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='gacha'/><b> Gacha</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='idle'/><b> Idle</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='match3'/><b> Match 3</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='multiplayer'/><b> Multiplayer</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='music'/><b> Music</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='piano'/><b> Piano</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='pixelated'/><b> Pixelated</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='ported'/><b> Ported</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='puzzle'/><b> Puzzle</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='rhythm'/><b> Rhythm</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='rpg'/><b> Role Playing</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='sandbox'/><b> Sandbox</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='side scroller'/><b> Side Scroller</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='social media'/><b> Social Media</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='strategy'/><b> Strategy</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='third person'/><b> Third Person</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='tower defense'/><b> Tower Defense</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='free'/><b> Free</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='paid'/><b> Paid</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='IAP'/><b> IAP</b><br></div>
      <div class='col-md-3'><input type='checkbox' name='sorting' value='no IAP'/><b> No IAP</b><br></div>
    <div class='row'>
      <div class='col-md-12'><button class='btn btn-primary' type='button' id='filter'>Filter</button></div>
    </div>
  </div>

  <div id='gameModal' class='modal' role='dialog' aria-hidden='true' aria-labelledby='game-modal' tabindex='-1'>
    <div class='modal-dialog'>
      <div class='modal-content'>
        <div class='modal-header'>
          <button class='btn btn-default' data-dismiss='modal' style='float;right;'>&times;</button>
        </div>
        <div class='modal-body' style='position:relative; height: 600px; overflow: scroll;'>
          <div id='game-icon'>
            <img src='#' style='width: 100px; height:100px; border-radius:20px;'>
          </div>
          <div id='game-info' style='position:absolute; top: 10px; left:130px;'>
          </div>
          <div id='game-rating' style='position:absolute; top: 70px; left: 130px;'>
          </div>
          <div id='game-tags' style='position:absolute; top: 120px;left:10px;'>
          </div>
          <div id='ios-version' style='position:absolute; top: 150px; left:10px;'>
          </div>
          <div id='info-page' style='position:absolute; top: 175px; left:10px;'>
          </div>
        </div>
        <div class='modal-footer'>
          <button class='btn btn-primary' data-dismiss='modal'>Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- <div id='screenshotCarousel' class='carousel slide carousel-fit' data-ride='carousel' data-interval='60000'>
    <div class='carousel-inner'>
    </div>
    <a class='left carousel-control' href='#screenshotCarousel' data-slide='prev'>
      <span class='glyphicon glyphicon-chevron-left'></span>
    </a>
    <a class='right carousel-control' href='#screenshotCarousel' data-slide='next'>
      <span class='glyphicon glyphicon-chevron-right'></span>
    </a>
  </div> -->


  <!-- <div id='screenshotModal' class='modal' tabindex='-1' role='dialog' aria-labelledby='screenModal' aria-hidden='true'>
    <div class='modal-dialog'>
      <div class='modal-content'>
        <div class='modal-header'>
          <button class='btn btn-default close' data-dismiss='modal' aria-hidden='true'>&times;</button>
        </div>
        <div class='modal-body'>
        </div>
        <div class='modal-footer'>
          <button class='btn btn-primary' data-dismiss='modal'>Close</button>
        </div>
      </div>
    </div>
  </div> -->

  <div class='container-fluid' id='gameView'>
  </div>
</div>

<script type='text/javascript'>

function postSuggestion() {
  var name = $('#gamename').val();
  var tags = $('#gametags').val();
  $.ajax({
    url: 'https://docs.google.com/forms/d/1fbk4UIj3ecQzsTSuF5WufvsrWKf4e8ntZpRYTj-q_dA/formResponse',
    data: {'entry.240804897': name, 'entry.1730167525': tags},
    type: 'POST',
    dataType: 'xml',
    statusCode: {
      0: function() {
        $('#gamename').val('');
        $('#gametags').val('');
      },
      200: function() {
        $('#gamename').val('');
        $('#gametags').val('');
      }
    }
  }).done( function(data) {
    console.log(data);
  });
}

function searchDevOrName(input) {
  shown = [];
  var query = input.toLowerCase().replace(/^\s\s*/, '').replace(/\s\s*$/, '');
  if (query.length < 2) {
    $(gameView).html('<h4><b>Not enough characters. Try again.</b></h4>');
  } else {
    for (var game in gameList) {
      if (gameList[game]['name'].toLowerCase().search(query) != -1 || gameList[game]['developer'].toLowerCase().search(query) != -1) {
        shown.push(gameList[game]['collapsedInfo']);
      }
    }
    (shown.length === 0) ? $(gameView).html('No results found.') : $(gameView).html(shown.join(' '));
  }
}

function filterByTags(tags) {
  shown = [];
  for (var game in gameList) {
    var add = true;
    for (var tag in tags) {
      if ($.inArray(tags[tag], gameList[game]['tags']) === -1) {
        add = false;
      }
    }
    if (add === true) {
      shown.push(gameList[game]['collapsedInfo']);
    }
  }
  (shown.length === 0) ? $(gameView).html('No games satisfy these. Make one yourself!') : $(gameView).html(shown.join(' '));
}

$(document).ready( function(e) {
  gameList = [];
  Tabletop.init( {
    key: '1SJr0dKWrsxPr2Y0D3NqLIfiS8Bnen7khEk5wsH6R2ZY',
    orderby: 'id',
    callback: buildList,
    simpleSheet: true
  });

  $('#searchField').keypress( function(e) {
    if (e.keyCode == 13) {
      searchDevOrName($('#searchField').val());
    }
  })
})
</script>
</body>
</html>


<!-- game div -->
<!--
width 650, height: 250
name
icon: 150 by 150
developer
screenshot on side: clicking on it brings up modal slideshow
on the side (absolute position):
tags: up to 2 per line or something :P
external app store link on bottom
-->
